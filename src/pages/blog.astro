---
import BaseLayout from "../layout/BaseLayout.astro";
import { getPosts } from "../api/getPosts";
import { formatDate } from "src/utils/date";
import { calculateReadingTime } from "src/utils/readingTime";

const posts = await getPosts();

const pageTitle: string = "All Posts";
---

<BaseLayout pageTitle={pageTitle}>
  <div class="total">Total: {posts.length}</div>
  <div class="post-list">
    {
      posts.map((post) => (
        <a href={`/blog/${post.slug}`} class="post-item">
          <div class="thumb" />
          <div class="title">{post.title}</div>
          <div class="tags">
            {post.tags.map((tag: string) => (
              <div class="tag">{tag}</div>
            ))}
          </div>
          <div class="time-info">
            <div class="created-at">{formatDate(post.created_at)}</div>
            <div class="bullet">â€¢</div>
            <div class="reading-time">
              {calculateReadingTime(post.content)} min read
            </div>
          </div>
        </a>
      ))
    }
  </div>
</BaseLayout>

<style>
  .total {
    font-size: 16px;
  }
  .post-list {
    display: flex;
    flex-direction: column;
    gap: 48px;
    margin-top: 48px;

    .title {
      font-size: 24px;
      font-weight: 700;
    }

    .post-item {
      text-decoration: none;
      color: white;
      display: flex;
      padding: 24px;
      border-radius: 8px;
      border: 1px solid #fcfcfc;
      flex-direction: column;
      gap: 16px;

      &:hover {
        background-color: #242424;
        border: 1px solid #b2b2b2;
      }
    }

    .time-info {
      display: flex;
      flex-direction: row;
      gap: 8px;
      .created-at {
        font-style: italic;
      }
    }

    .tags {
      display: flex;
      gap: 8px;

      .tag {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 4px 8px;
        background-color: #525252;
        border-radius: 100px;
        font-size: 14px;
      }
    }
  }
</style>
